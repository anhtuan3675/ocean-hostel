USE	OCEAN_HOSTEL
GO

--DROP TRIGGER TRGR__KHU__INSERT

CREATE	TRIGGER	dbo.TRGR__KHU__INSERT	ON KHU
FOR INSERT
AS
BEGIN
	
	IF EXISTS (SELECT *
				FROM KHU k, deleted d
				WHERE k.MAKHU = d.MAKHU)
	BEGIN
		ROLLBACK
	END
	
END



CREATE	TRIGGER	TRGR__KHU__DELETE	ON	KHU
FOR DELETE
AS
BEGIN
	
	DECLARE @DELETED_MAKHU VARCHAR(10)
	SET @DELETED_MAKHU = (SELECT MAKHU FROM deleted)
	
	DELETE FROM TANG
	WHERE MAKHU = @DELETED_MAKHU
	
END